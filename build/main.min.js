/*!  2016-08-26 */
function saveAudio(){audioRecorder.exportWAV(doneEncoding)}function gotBuffers(a){var b=document.getElementById("wavedisplay");drawBuffer(b.width,b.height,b.getContext("2d"),a[0]),audioRecorder.exportWAV(doneEncoding)}function doneEncoding(a){Recorder.setupDownload(a,"myRecording"+(recIndex<10?"0":"")+recIndex+".wav"),recIndex++}function toggleRecording(a){if(a.classList.contains("recording"))audioRecorder.stop(),a.classList.remove("recording"),audioRecorder.getBuffers(gotBuffers),document.getElementById("record").src="/img/btn_record_inactive.png";else{if(!audioRecorder)return;a.classList.add("recording"),audioRecorder.clear(),audioRecorder.record(),document.getElementById("record").src="/img/btn_record_active.png"}}function convertToMono(a){var b=audioContext.createChannelSplitter(2),c=audioContext.createChannelMerger(2);return a.connect(b),b.connect(c,0,0),b.connect(c,0,1),c}function cancelAnalyserUpdates(){window.cancelAnimationFrame(rafID),rafID=null}function updateAnalysers(a){if(!analyserContext){var b=document.getElementById("analyser");canvasWidth=b.width,canvasHeight=b.height,analyserContext=b.getContext("2d")}var c=1,d=new Uint8Array(analyserNode.frequencyBinCount);analyserNode.getByteFrequencyData(d),analyserContext.clearRect(0,0,canvasWidth,canvasHeight),analyserContext.fillStyle="#F6D565",analyserContext.lineCap="round";for(var e=analyserNode.frequencyBinCount/c,f=(analyserNode.maxDecibels,analyserNode.minDecibels,0);f<c;++f){for(var g=0,h=Math.floor(f*e),i=0;i<e;i++)g+=d[h+i];g=g/e*5;d[f*e];analyserContext.fillStyle="hsl( 115, 100%, 100%)",analyserContext.fillRect(0,0,g,canvasHeight)}rafID=window.requestAnimationFrame(updateAnalysers)}function toggleMono(){audioInput!=realAudioInput?(audioInput.disconnect(),realAudioInput.disconnect(),audioInput=realAudioInput):(realAudioInput.disconnect(),audioInput=convertToMono(realAudioInput)),audioInput.connect(inputPoint)}function gotStream(a){inputPoint=audioContext.createGain(),realAudioInput=audioContext.createMediaStreamSource(a),audioInput=realAudioInput,audioInput.connect(inputPoint),analyserNode=audioContext.createAnalyser(),analyserNode.fftSize=2048,inputPoint.connect(analyserNode),audioRecorder=new Recorder(inputPoint),zeroGain=audioContext.createGain(),zeroGain.gain.value=0,inputPoint.connect(zeroGain),zeroGain.connect(audioContext.destination),updateAnalysers()}function initAudio(){navigator.getUserMedia||(navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia),navigator.cancelAnimationFrame||(navigator.cancelAnimationFrame=navigator.webkitCancelAnimationFrame||navigator.mozCancelAnimationFrame),navigator.requestAnimationFrame||(navigator.requestAnimationFrame=navigator.webkitRequestAnimationFrame||navigator.mozRequestAnimationFrame),navigator.getUserMedia({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"},optional:[]}},gotStream,function(a){alert("Error getting audio, please check your microphone's connection or the microphone setting of your current browser."),console.log(a)})}window.AudioContext=window.AudioContext||window.webkitAudioContext;var audioContext=new AudioContext,audioInput=null,realAudioInput=null,inputPoint=null,audioRecorder=null,rafID=null,analyserContext=null,canvasWidth,canvasHeight,recIndex=0;window.addEventListener("load",initAudio);